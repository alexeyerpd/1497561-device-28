const left=document.querySelector(".range__left"),right=document.querySelector(".range__right"),outputLeft=document.querySelector(".range__output-left"),outputRight=document.querySelector(".range__output-right"),indicator=document.querySelector(".range__indicator"),track=document.querySelector(".range__track"),trackRect=track.getBoundingClientRect(),activeList=[];class RangeSlider{constructor(a,b,c,d){this.range=a,this.track=b,this.sliderLeft=c,this.sliderRight=d,this.trackLength=0,this.stepLength=0}init(){this.trackLength=trackRect.width-2*this.sliderLeft.boundingData.width,this.stepLength=this.range/this.trackLength,this.update()}update(){const a=Math.floor(this.stepLength*this.sliderLeft.currentPosition),b=Math.floor((this.trackLength-this.sliderRight.currentPosition)*this.stepLength);this.updateIndicator(),outputLeft.textContent=`от ${a}`,outputRight.textContent=`до ${b}`}updateIndicator(){const a=this.sliderLeft.currentPosition+this.sliderLeft.boundingData.width/2,b=this.sliderRight.currentPosition+this.sliderRight.boundingData.width/2;indicator.style.left=`${a}px`,indicator.style.right=`${b}px`}}class Slider{constructor(a,b){this.element=a,this.boundingData=a.getBoundingClientRect(),this.isMove=!1,this.direction=b,this.currentPosition=0,this.initialCoord={positionStart:0,clientXStart:0},this.element.addEventListener("mousedown",a=>{this.isMove=!0,this.updateBounding(),this.updateCurrentCoord(),this.initialCoord.clientXStart=a.clientX,activeList.push(this)})}updateBounding(){this.boundingData=this.element.getBoundingClientRect()}onMove(){this.isMove=!0}onStop(){this.isMove=!1}updateCurrentCoord(){this.initialCoord.positionStart=parseFloat(this.element.style[this.direction])||0}updatePosition(a,b){const{width:c}=this.boundingData,{positionStart:d,clientXStart:e}=this.initialCoord;let f;const g=trackRect.width-(b.initialCoord.positionStart+2*c);if("left"===this.direction){f=Math.max(0,Math.min(d+(a-e),g))}else{f=Math.max(0,Math.min(d+(-a+e),g))}this.element.style[this.direction]=`${f}px`,this.currentPosition=f}}const sliderLeft=new Slider(left,"left"),sliderRight=new Slider(right,"right"),rangeSlider=new RangeSlider(5e3,track,sliderLeft,sliderRight);rangeSlider.init();function onMove(a){const b=activeList[0];if(b&&b.isMove){const c=sliderLeft===b?sliderRight:sliderLeft;b.updatePosition(a.clientX,c),rangeSlider.update()}}function onForbidden(){activeList[0]&&(activeList[0].onStop(),activeList[0].updateCurrentCoord(),activeList.pop())}document.addEventListener("mouseup",onForbidden),document.addEventListener("mousemove",onMove);